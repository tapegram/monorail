-- form utilities

web.form.getOnly : Text -> Map Text [Text] -> Optional Text
web.form.getOnly name formData = match Map.get name formData with
  Some (value +: _) -> Some value
  _                 -> Optional.None
  
web.form.getOnly! : Text -> Map Text [Text] ->{Exception} Text
web.form.getOnly! name formData = 
  getOnly name formData
    |> (cases
      Some v -> v
      Optional.None ->
        Exception.raise (failure ("Expected form value: " Text.++ name) name))
