-- {{pascalCase pageName}} Page, Controller, and Route
-- Generated by Monorail (plop)

-- =============================================================================
-- PAGE
-- =============================================================================

app.pages.{{camelCase pageName}}.view : '{Route} Html
app.pages.{{camelCase pageName}}.view = do
  use {{htmlLib}} article h1 p section text

  article []
    [ h1 [] [text "{{pascalCase pageName}}"]
    , section []
        [ p [] [text "Welcome to the {{pascalCase pageName}} page."]
        -- TODO: Add your content here
        ]
    ]

-- =============================================================================
-- CONTROLLER
-- =============================================================================

app.controllers.{{pascalCase pageName}}Controller.show :
  {Route, Exception, Log} HttpResponse
app.controllers.{{pascalCase pageName}}Controller.show =
  html = app.pages.{{camelCase pageName}}.view ()
  ok.html (page.page [html] [])

{{#if hasParams}}
app.controllers.{{pascalCase pageName}}Controller.showWithId :
  Text ->
  {Route, Exception, Log} HttpResponse
app.controllers.{{pascalCase pageName}}Controller.showWithId id =
  -- TODO: Use the id to fetch data
  html = app.pages.{{camelCase pageName}}.view ()
  ok.html (page.page [html] [])
{{/if}}

-- =============================================================================
-- ROUTE
-- =============================================================================

app.routes.{{camelCase pageName}} : '{Route, Log, Exception} ()
app.routes.{{camelCase pageName}} =
  use Parser / s

  handler = do
{{#if hasParams}}
    id = route {{httpMethod}} (s "{{routePath}}" / Parser.text)
    app.controllers.{{pascalCase pageName}}Controller.showWithId id
{{else}}
    noCapture {{httpMethod}} (s "{{routePath}}")
    app.controllers.{{pascalCase pageName}}Controller.show
{{/if}}
  handler

-- =============================================================================
-- INTEGRATION
-- =============================================================================

{-
Add this route to your main routes composition:

app.routes db =
  use Route <|>
  -- ... existing routes ...
  app.routes.{{camelCase pageName}} <|> otherRoutes

The page will be available at: /{{routePath}}
-}
